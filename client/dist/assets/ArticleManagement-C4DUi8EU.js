import{_ as V,o as $,a as h,c as A,b,d as t,w as r,n as E,B as N,C as T,g as j,e as I,f as g,t as K,i as C,E as d,j as s,r as i,k as P,l as S}from"./index-B2nFemfM.js";const U={class:"article-management"},L={class:"header"},q={__name:"ArticleManagement",setup(F){const f=i([]),p=i(!1),m=i(""),_=i(1),v=i(10),w=i(0),c=async()=>{var a,e,u;p.value=!0;try{const o=await C.get("/admin/articles",{params:{page:_.value-1,size:v.value,keyword:m.value||void 0}});f.value=o.content,w.value=o.totalElements}catch(o){console.error("加载文章列表失败:",o);const l=((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.error)||o.message||"加载文章列表失败";d.error(l),((u=o.response)==null?void 0:u.status)===403&&d.error("您没有权限访问此功能，请确认您已登录管理员账号")}finally{p.value=!1}},x=async a=>{try{await S.confirm(`确定要删除文章 "${a.title}" 吗？此操作不可恢复！`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await C.delete(`/admin/articles/${a.id}`),d.success("删除成功"),c()}catch(e){e!=="cancel"&&d.error("删除失败")}},k=a=>a?new Date(a).toLocaleString("zh-CN"):"";return $(()=>{c()}),(a,e)=>{const u=s("el-icon"),o=s("el-input"),l=s("el-table-column"),y=s("el-button"),B=s("el-table"),z=s("el-pagination"),D=P("loading");return h(),A("div",U,[b("div",L,[e[2]||(e[2]=b("h2",null,"文章管理",-1)),t(o,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),placeholder:"搜索文章（标题/内容）",style:{width:"300px"},clearable:"",onClear:c,onKeyup:T(c,["enter"])},{prefix:r(()=>[t(u,null,{default:r(()=>[t(E(N))]),_:1})]),_:1},8,["modelValue"])]),j((h(),I(B,{data:f.value,style:{width:"100%"}},{default:r(()=>[t(l,{prop:"id",label:"ID",width:"80"}),t(l,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),t(l,{prop:"author.username",label:"作者",width:"120"}),t(l,{prop:"viewCount",label:"阅读",width:"80"}),t(l,{prop:"likeCount",label:"点赞",width:"80"}),t(l,{prop:"category.name",label:"分类",width:"120"}),t(l,{prop:"createdAt",label:"发布时间",width:"180"},{default:r(({row:n})=>[g(K(k(n.createdAt)),1)]),_:1}),t(l,{label:"操作",width:"150",fixed:"right"},{default:r(({row:n})=>[t(y,{size:"small",type:"primary",onClick:M=>a.$router.push(`/article/${n.id}`)},{default:r(()=>[...e[3]||(e[3]=[g(" 查看 ",-1)])]),_:1},8,["onClick"]),t(y,{size:"small",type:"danger",onClick:M=>x(n)},{default:r(()=>[...e[4]||(e[4]=[g(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,p.value]]),t(z,{"current-page":_.value,"onUpdate:currentPage":e[1]||(e[1]=n=>_.value=n),"page-size":v.value,total:w.value,layout:"total, prev, pager, next",onCurrentChange:c,style:{"margin-top":"20px","justify-content":"center"}},null,8,["current-page","page-size","total"])])}}},H=V(q,[["__scopeId","data-v-98d3a045"]]);export{H as default};
