import{_ as M,o as V,a as h,c as $,b,d as t,w as r,k as E,y as N,z as T,A as I,e as K,g,t as P,h as C,E as d,r as s,i,B as S,C as U}from"./index-CFbs32FA.js";const j={class:"article-management"},L={class:"header"},q={__name:"ArticleManagement",setup(F){const v=i([]),p=i(!1),m=i(""),_=i(1),f=i(10),w=i(0),c=async()=>{var a,e,u;p.value=!0;try{const l=await C.get("/admin/articles",{params:{page:_.value-1,size:f.value,keyword:m.value||void 0}});v.value=l.content,w.value=l.totalElements}catch(l){console.error("加载文章列表失败:",l);const o=((e=(a=l.response)==null?void 0:a.data)==null?void 0:e.error)||l.message||"加载文章列表失败";d.error(o),((u=l.response)==null?void 0:u.status)===403&&d.error("您没有权限访问此功能，请确认您已登录管理员账号")}finally{p.value=!1}},x=async a=>{try{await U.confirm(`确定要删除文章 "${a.title}" 吗？此操作不可恢复！`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await C.delete(`/admin/articles/${a.id}`),d.success("删除成功"),c()}catch(e){e!=="cancel"&&d.error("删除失败")}},k=a=>a?new Date(a).toLocaleString("zh-CN"):"";return V(()=>{c()}),(a,e)=>{const u=s("el-icon"),l=s("el-input"),o=s("el-table-column"),y=s("el-button"),z=s("el-table"),B=s("el-pagination"),D=S("loading");return h(),$("div",j,[b("div",L,[e[2]||(e[2]=b("h2",null,"文章管理",-1)),t(l,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),placeholder:"搜索文章（标题/内容）",style:{width:"300px"},clearable:"",onClear:c,onKeyup:T(c,["enter"])},{prefix:r(()=>[t(u,null,{default:r(()=>[t(E(N))]),_:1})]),_:1},8,["modelValue"])]),I((h(),K(z,{data:v.value,style:{width:"100%"}},{default:r(()=>[t(o,{prop:"id",label:"ID",width:"80"}),t(o,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),t(o,{prop:"author.username",label:"作者",width:"120"}),t(o,{prop:"viewCount",label:"阅读",width:"80"}),t(o,{prop:"likeCount",label:"点赞",width:"80"}),t(o,{prop:"category.name",label:"分类",width:"120"}),t(o,{prop:"createdAt",label:"发布时间",width:"180"},{default:r(({row:n})=>[g(P(k(n.createdAt)),1)]),_:1}),t(o,{label:"操作",width:"150",fixed:"right"},{default:r(({row:n})=>[t(y,{size:"small",type:"primary",onClick:A=>a.$router.push(`/article/${n.id}`)},{default:r(()=>[...e[3]||(e[3]=[g(" 查看 ",-1)])]),_:1},8,["onClick"]),t(y,{size:"small",type:"danger",onClick:A=>x(n)},{default:r(()=>[...e[4]||(e[4]=[g(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,p.value]]),t(B,{"current-page":_.value,"onUpdate:currentPage":e[1]||(e[1]=n=>_.value=n),"page-size":f.value,total:w.value,layout:"total, prev, pager, next",onCurrentChange:c,style:{"margin-top":"20px","justify-content":"center"}},null,8,["current-page","page-size","total"])])}}},H=M(q,[["__scopeId","data-v-98d3a045"]]);export{H as default};
